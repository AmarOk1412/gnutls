@node danetool Invocation
@section Invoking danetool
@pindex danetool
@cindex GnuTLS DANE tool
@ignore
#  -*- buffer-read-only: t -*- vi: set ro:
# 
# DO NOT EDIT THIS FILE   (invoke-danetool.texi)
# 
# It has been AutoGen-ed  October 12, 2012 at 05:34:36 PM by AutoGen 5.16
# From the definitions    ../src/danetool-args.def
# and the template file   agtexi-cmd.tpl
@end ignore


Tool generate DNS resource records for the DANE protocol.

This section was generated by @strong{AutoGen},
using the @code{agtexi-cmd} template and the option descriptions for the @code{danetool} program.
This software is released under the GNU General Public License, version 3 or later.


@anchor{danetool usage}
@subheading danetool help/usage (-h)
@cindex danetool help

This is the automatically generated usage text for danetool.
The text printed is the same whether for the @code{help} option (-h) or the @code{more-help} option (-!).  @code{more-help} will print
the usage text by passing it through a pager program.
@code{more-help} is disabled on platforms without a working
@code{fork(2)} function.  The @code{PAGER} environment variable is
used to select the program, defaulting to @file{more}.  Both will exit
with a status code of 0.

@exampleindent 0
@example
danetool - GnuTLS DANE tool - Ver. @@VERSION@@
USAGE:  danetool [ -<flag> [<val>] | --<name>[@{=| @}<val>] ]...

   -d, --debug=num            Enable debugging.
                                - It must be in the range:
                                  0 to 9999
   -V, --verbose              More verbose output
                                - may appear multiple times
       --infile=file          Input file
                                - file must pre-exist
       --outfile=str          Output file
       --load-pubkey=str      Loads a public key file
       --load-certificate=str Loads a certificate file
       --hash=str             Hash algorithm to use for signing.
       --inder                Use DER format for input certificates and private keys.
                                - disabled as --no-inder
       --inraw                This is an alias for 'inder'
       --outder               Use DER format for output certificates and private keys
                                - disabled as --no-outder
       --outraw               This is an alias for 'outder'
       --tlsa-rr              Print the DANE RR data on a certificate or public key
                                - requires these options:
                                host
       --host=str             Specify the hostname to be used in the DANE RR
       --proto=str            The protocol set for DANE data (tcp, udp etc.)
       --port=num             Specify the port number for the DANE data.
       --ca                   Whether the provided certificate or public key is a Certificate
authority.
       --x509                 Use the hash of the X.509 certificate, rather than the public key.
       --local                The provided certificate or public key is a local entity.
   -v, --version[=arg]        Output version information and exit
   -h, --help                 Display extended usage information and exit
   -!, --more-help            Extended usage information passed thru pager

Options are specified by doubled hyphens and their name or by a single
hyphen and the flag character.



Tool generate DNS resource records for the DANE protocol.

please send bug reports to:  bug-gnutls@@gnu.org
@end example
@exampleindent 4

@anchor{danetool debug}
@subheading debug option (-d)
@cindex danetool-debug

This is the ``enable debugging.'' option.
This option takes an argument number.
Specifies the debug level.
@anchor{danetool load-pubkey}
@subheading load-pubkey option
@cindex danetool-load-pubkey

This is the ``loads a public key file'' option.
This option takes an argument string.
This can be either a file or a PKCS #11 URL
@anchor{danetool load-certificate}
@subheading load-certificate option
@cindex danetool-load-certificate

This is the ``loads a certificate file'' option.
This option takes an argument string.
This can be either a file or a PKCS #11 URL
@anchor{danetool hash}
@subheading hash option
@cindex danetool-hash

This is the ``hash algorithm to use for signing.'' option.
This option takes an argument string.
Available hash functions are SHA1, RMD160, SHA256, SHA384, SHA512.
@anchor{danetool inder}
@subheading inder option
@cindex danetool-inder

This is the ``use der format for input certificates and private keys.'' option.
The input files will be assumed to be in DER or RAW format. 
Unlike options that in PEM input would allow multiple input data (e.g. multiple 
certificates), when reading in DER format a single data structure is read.
@anchor{danetool inraw}
@subheading inraw option
@cindex danetool-inraw

This is an alias for the inder option,
@pxref{danetool inder, the inder option documentation}.

@anchor{danetool outder}
@subheading outder option
@cindex danetool-outder

This is the ``use der format for output certificates and private keys'' option.
The output will be in DER or RAW format.
@anchor{danetool outraw}
@subheading outraw option
@cindex danetool-outraw

This is an alias for the outder option,
@pxref{danetool outder, the outder option documentation}.

@anchor{danetool tlsa-rr}
@subheading tlsa-rr option
@cindex danetool-tlsa-rr

This is the ``print the dane rr data on a certificate or public key'' option.

@noindent
This option has some usage constraints.  It:
@itemize @bullet
@item
must appear in combination with the following options:
host.
@end itemize

This command prints the DANE RR data needed to enable DANE on a DNS server.
@anchor{danetool host}
@subheading host option
@cindex danetool-host

This is the ``specify the hostname to be used in the dane rr'' option.
This option takes an argument string @file{Hostname}.
This command sets the hostname for the DANE RR.
@anchor{danetool proto}
@subheading proto option
@cindex danetool-proto

This is the ``the protocol set for dane data (tcp, udp etc.)'' option.
This option takes an argument string @file{Protocol}.
This command specifies the protocol for the service set in the DANE data.
@anchor{danetool ca}
@subheading ca option
@cindex danetool-ca

This is the ``whether the provided certificate or public key is a certificate authority.'' option.
Marks the DANE RR as a CA certificate if specified.
@anchor{danetool x509}
@subheading x509 option
@cindex danetool-x509

This is the ``use the hash of the x.509 certificate, rather than the public key.'' option.
This option forces the generated record to contain the hash of the full X.509 certificate. By default only the hash of the public key is used.
@anchor{danetool local}
@subheading local option
@cindex danetool-local

This is the ``the provided certificate or public key is a local entity.'' option.
DANE distinguishes certificates and public keys offered via the DNSSEC to trusted and local entities. Use this flag if this is a local (and possibly unsigned) entity.
@anchor{danetool exit status}
@subheading danetool exit status

One of the following exit values will be returned:
@table @samp
@item 0 (EXIT_SUCCESS)
Successful program execution.
@item 1 (EXIT_FAILURE)
The operation failed or the command syntax was not valid.
@end table
@anchor{danetool See Also}
@subheading danetool See Also
    p11tool (1)

@anchor{danetool Examples}
@subheading danetool Examples
@subheading DANE TLSA RR generation

To create a DANE TLSA resource record for a CA signed certificate use the following commands.

@example
$ certtool --tlsa-rr --host www.example.com --load-certificate cert.pem
@end example

For a self signed certificate use:
@example
$ certtool --tlsa-rr --host www.example.com --load-certificate cert.pem \
  --local
@end example

The latter is useful to add in your DNS entry even if your certificate is signed 
by a CA. That way even users who do not trust your CA will be able to verify your
certificate using DANE.

In order to create a record for the signer of your certificate use:
@example
$ certtool --tlsa-rr --host www.example.com --load-certificate cert.pem \
  --ca
@end example

To read a server's DANE TLSA entry, using the dig tool, use:
@example
$ dig +short TYPE52 _443._tcp.www.example.com
@end example

