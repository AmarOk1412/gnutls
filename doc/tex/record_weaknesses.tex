\subsection*{Weaknesses and countermeasures}
\index{TLS protocols!Record}

Some weaknesses that may affect the security of the Record layer have been
found in \tlsI{} protocol. These weaknesses can be exploited by active attackers,
and exploit the facts that
\begin{enumerate}
\item \tls{} has separate alerts for ``decryption\_failed'' and ``bad\_record\_mac''
\item the decryption failure reason can be detected by timing the response time
\item the IV for CBC encrypted packets is the last block of the previous encrypted packet
\end{enumerate}

Those weaknesses were solved in \tlsII{} which is implemented in
\gnutls{}. For a detailed discussion see the archives of the TLS Working Group mailing list
and the paper \cite{CBCATT}.

