\section{Authentication using SRP\index{SRP authentication}}

Authentication using the SRP\footnote{SRP stands for Secure Remote Password and 
is described in \cite{RFC2945}. The SRP key exchange is not a part of the \tlsI{} protocol}
protocol is actually password authentication. The two peers can be identified using a
single password, or there can be combinations where the client is 
authenticated using SRP and the server using a certificate.
\par
The advantage of SRP authentication, over other proposed secure password 
authentication schemas, is that SRP does not require the server to hold
the user's password. This kind of protection is similar to the one used traditionally
in the \emph{UNIX} ``passwd'' file, where the contents of this file did not cause
harm to the system security if they were revealed.
The SRP needs instead of the plain password something called a verifier, 
which is calculated using the user's password, and if stolen cannot
be used to impersonate the user. See \cite{TOMSRP} for a detailed description
of the SRP protocol, and for the Stanford SRP libraries.

\par
The implementation in \gnutls{} is based on paper \cite{TLSSRP}.
The available key exchange methods are shown in \hyperref{figure}{figure }{}{fig:srp}.

\begin{figure}[hbtp]
\begin{tabular}{|l|p{9cm}|}

\hline
SRP & Authentication using the SRP protocol. 
\\
\hline
SRP\_DSS & Client authentication using the SRP protocol. Server is 
authenticated using a certificate with DSA parameters.
\\
\hline
SRP\_RSA & Client authentication using the SRP protocol. Server is 
authenticated using a certificate with RSA parameters.
\\
\hline
\end{tabular}

\caption{Supported SRP key exchange algorithms}
\label{fig:srp}

\end{figure}

If clients supporting SRP know the username and password before the connection,
should initialize the client credentials and call the
function \printfunc{gnutls_srp_set_client_credentials}{gnutls\_srp\_set\_client\_credentials}.
Alternatively they could specify a callback function by using the
function \printfunc{gnutls_srp_set_client_credentials_function}{gnutls\_srp\_set\_client\_credentials\_function}.
This has the advantage that allows probing the server for SRP support.
In that case the callback function will be called twice per handshake.
The first time is before the ciphersuite is negotiated, and 
if the callback returns a negative error code, the callback will be 
called again if SRP has been negotiated. 
This uses a special TLS-SRP handshake idiom in order to avoid, in
interactive applications, to ask the user for SRP password and username 
if the server does not negotiate an SRP ciphersuite.
\par
In server side the default behaviour of \gnutls{} is to read the usernames 
and SRP verifiers from password files. These password files are the ones used
by the \emph{srp libraries} and can be specified using the
\printfunc{gnutls_srp_set_server_credentials_file}{gnutls\_srp\_set\_server\_credentials\_file}.
If a different password file format is to be used, then the 
function \printfunc{gnutls_srp_set_server_credentials_function}{gnutls\_srp\_set\_server\_credentials\_function},
should be called, in order to set an appropriate callback.
\par
Some helper functions such as
\begin{itemize}
\item \printfunc{gnutls_srp_verifier}{gnutls\_srp\_verifier}
\item \printfunc{gnutls_srp_base64_encode}{gnutls\_srp\_base64\_encode}
\item \printfunc{gnutls_srp_base64_decode}{gnutls\_srp\_base64\_decode}
\end{itemize}
are included in \gnutls{}, and may be used to generate, and maintain
SRP verifiers, and password files. 
A program to manipulate the required parameters 
for SRP authentication is also included. See section \ref{srpcrypt} on 
page \pageref{srpcrypt} for more information.

